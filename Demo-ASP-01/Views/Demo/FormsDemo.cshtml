@using Microsoft.AspNetCore.Mvc.ModelBinding
@using Demo_ASP_01.Models.Demo
@model FormsDemoForm
<!DOCTYPE html>
<html lang="fr">
<head>
    <title>Demo ASP MVC : @ViewData["Title"]</title>
    <link rel="stylesheet" type="text/css" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/css/site.css"/>
</head>
<body>
    <h1>Demo ASP MVC</h1>
    @if(TempData.ContainsKey("errorMessage")){
        <div style="background-color : #FF7777; color : #880000">
            <p>@TempData["errorMessage"]</p>
        </div>
    }
    @if(!ViewContext.ModelState.IsValid){
        @*<div style="background-color : #FF7777; color : #880000">
            <p>Votre formulaire contient @ViewContext.ModelState.ErrorCount erreur(s) :</p>
            <ul>
                @foreach(KeyValuePair<string,ModelStateEntry> entry in ViewContext.ModelState){
                    if(entry.Value.Errors.Count > 0){
                        <li>@entry.Key : 
                            <ul>
                                @foreach(ModelError error in entry.Value.Errors){
                                    <li>@error.ErrorMessage</li>
                                }
                            </ul>
                        </li>
                    }
                }

            </ul>
        </div>*@
        @Html.ValidationSummary(true,
                $"Votre formulaire contient {ViewContext.ModelState.ErrorCount} erreur(s) :",
                new { @class = "alert alert-danger", style = "width : 75%; margin : 0 auto"}
        )
    }
    <h2>Démonstrations des formulaires</h2>
    <div class="row">
        <form method="post" class="col-6 container-md">
            <div class="mb-3">
                <label for="title">Titre :</label>
                @*<select name="title" class="form-select">
                    <option value="none">Pas de titre</option>
                    <option value="mme">Mme</option>
                    <option value="mr">Mr</option>
                    <option value="dr">Dr</option>
                </select>*@
                @Html.DropDownListFor( m => m.Title,
                    new List<SelectListItem>(){
                new SelectListItem() {Value = "none", Text="Pas de titre"},
                new SelectListItem() {Value = "mme", Text="Mme"},
                new SelectListItem() {Value = "mr", Text="Mr"},
                new SelectListItem() {Value = "dr", Text="Dr"}
                    },
                    null, 
                    new { @class="form-select"}
                    )
                @Html.ValidationMessageFor(m => m.Title, null, new {@class = "text-danger"})
            </div>
            <div class="mb-3">
                <label for="firstName" class="form-label">Prénom : </label>
                @*<input id="firstName" name="firstName" type="text" class="form-control"/>
               @if(ViewContext.ModelState.ContainsKey("firstName")){
                    @foreach (ModelError error in ViewContext.ModelState["firstName"].Errors){
                        <br /><span class="text-danger">@error.ErrorMessage</span>
                    }
                }*@
                @Html.EditorFor(m => m.FirstName, new{ htmlAttributes = new {@class = "form-control"}})
                @Html.ValidationMessageFor(m => m.FirstName, null, new {@class = "text-danger"})
            </div>
            <div class="mb-3">
                <label for="lastName" class="form-label">Nom : </label>
                @Html.EditorFor(m => m.LastName, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(m => m.LastName, null, new {@class = "text-danger"})
            </div>
            <div class="mb-3">
                <label for="birthDate" class="form-label">Date de naissance : </label>
                @Html.EditorFor(m => m.BirthDate, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(m => m.BirthDate, "Le champ Date de naissance est invalide", new { @class = "text-danger" })
            </div>
        <div>
            <button type="submit" class="btn btn-success">Enregistrer</button>
            <button type="reset" class="btn btn-warning">Vider formulaire</button>
            @* <a href="/Demo/" class="btn btn-danger">Revenir en arrière</a> *@
            @Html.ActionLink("Revenir en arrière", "Index", "Demo", null, new { @class = "btn btn-danger" })
        </div>
    </form>
    </div>
</body>
</html>
